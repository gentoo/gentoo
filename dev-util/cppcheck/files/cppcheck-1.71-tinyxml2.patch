--- cppcheck-1.71/gui/gui.pro
+++ cppcheck-1.71/gui/gui.pro
@@ -14,7 +14,7 @@
     LIBS += -l../bin/cppcheck-core
     DEFINES += CPPCHECKLIB_IMPORT
 }
-LIBS += -L$$PWD/../externals
+LIBS += `pkg-config --libs tinyxml2`
 
 DESTDIR = .
 RCC_DIR = temp
--- cppcheck-1.71/tools/dmake.cpp
+++ cppcheck-1.71/tools/dmake.cpp
@@ -174,7 +174,6 @@
     }
 
     std::vector<std::string> externalfiles;
-    getCppFiles(externalfiles, "externals/", true);
 
 
     // QMAKE - lib/lib.pri
@@ -183,10 +182,6 @@
         if (fout1.is_open()) {
             fout1 << "# no manual edits - this file is autogenerated by dmake\n\n";
             fout1 << "include($$PWD/pcrerules.pri)\n";
-            fout1 << "BASEPATH = ../externals/tinyxml/\n";
-            fout1 << "include($$PWD/../externals/tinyxml/tinyxml.pri)\n";
-            fout1 << "BASEPATH = ../lib/\n";
-            fout1 << "INCLUDEPATH += ../externals/tinyxml\n";
             fout1 << "HEADERS += $${BASEPATH}check.h \\\n";
             for (unsigned int i = 0; i < libfiles.size(); ++i) {
                 std::string fname(libfiles[i].substr(4));
@@ -212,7 +207,6 @@
         std::ofstream fout1("test/testfiles.pri");
         if (fout1.is_open()) {
             fout1 << "# no manual edits - this file is autogenerated by dmake\n\n";
-            fout1 << "INCLUDEPATH += ../externals/tinyxml\n";
             fout1 << "\n\nSOURCES += ";
             for (unsigned int i = 0; i < testfiles.size(); ++i) {
                 const std::string filename(testfiles[i].substr(5));
@@ -376,9 +370,9 @@
          << "endif\n\n";
 
     makeConditionalVariable(fout, "PREFIX", "/usr");
-    makeConditionalVariable(fout, "INCLUDE_FOR_LIB", "-Ilib -Iexternals/tinyxml");
-    makeConditionalVariable(fout, "INCLUDE_FOR_CLI", "-Ilib -Iexternals/tinyxml");
-    makeConditionalVariable(fout, "INCLUDE_FOR_TEST", "-Ilib -Icli -Iexternals/tinyxml");
+    makeConditionalVariable(fout, "INCLUDE_FOR_LIB", "-Ilib");
+    makeConditionalVariable(fout, "INCLUDE_FOR_CLI", "-Ilib");
+    makeConditionalVariable(fout, "INCLUDE_FOR_TEST", "-Ilib -Icli");
 
     fout << "BIN=$(DESTDIR)$(PREFIX)/bin\n\n";
     fout << "# For 'make man': sudo apt-get install xsltproc docbook-xsl docbook-xml on Linux\n";
@@ -419,10 +413,10 @@
     fout << "\t$(CXX) $(CXXFLAGS) -o dmake tools/dmake.o cli/filelister.o cli/pathmatch.o lib/path.o -Ilib $(LDFLAGS)\n\n";
     fout << "run-dmake: dmake\n";
     fout << "\t./dmake\n\n";
-    fout << "reduce:\ttools/reduce.o externals/tinyxml/tinyxml2.o $(LIBOBJ)\n";
-    fout << "\t$(CXX) $(CPPFLAGS) $(CXXFLAGS) -g -o reduce tools/reduce.o -Ilib -Iexternals/tinyxml $(LIBOBJ) $(LIBS) externals/tinyxml/tinyxml2.o $(LDFLAGS) $(RDYNAMIC)\n\n";
+    fout << "reduce:\ttools/reduce.o $(LIBOBJ)\n";
+    fout << "\t$(CXX) $(CPPFLAGS) $(CXXFLAGS) -o reduce tools/reduce.o -Ilib $(LIBOBJ) $(LIBS) $(LDFLAGS) $(RDYNAMIC)\n\n";
     fout << "clean:\n";
-    fout << "\trm -f build/*.o lib/*.o cli/*.o test/*.o tools/*.o externals/tinyxml/*.o testrunner reduce dmake cppcheck cppcheck.1\n\n";
+    fout << "\trm -f build/*.o lib/*.o cli/*.o test/*.o tools/*.o testrunner reduce dmake cppcheck cppcheck.1\n\n";
     fout << "man:\tman/cppcheck.1\n\n";
     fout << "man/cppcheck.1:\t$(MAN_SOURCE)\n\n";
     fout << "\t$(XP) $(DB2MAN) $(MAN_SOURCE)\n\n";
