author:	gentoo-repo-qa-bot
association:	collaborator
edited:	false
status:	none
--
## Pull request CI report

*Report generated at*: 2023-07-03 12:40 UTC
*Newest commit scanned*: 7e5a7aae874b737a6ce19b45fa9e91dea96c2bc8
*Status*: :white_check_mark: good

There are existing issues already. Please look into the report to make sure none of them affect the packages in question:
https://qa-reports.gentoo.org/output/gentoo-ci/fee56a2a07/output.html

--
author:	mattst88
association:	contributor
edited:	false
status:	none
--
Does `webkit-gtk` build for you, and if so, how does its compilation time compare to 2.40?

I'm seeing some `cc1plus` processes running for an insanely long time -- like 13 minutes at least.
--
author:	mattst88
association:	contributor
edited:	false
status:	none
--
```
 * One or more CMake variables were not used by the project:                                                      │
 *   CMAKE_DISABLE_FIND_PACKAGE_OpenGL                                                                            │
 *   CMAKE_DISABLE_FIND_PACKAGE_OpenGLES2                                                                         │
 *   ENABLE_GLES2                                                                                                 │
```
--
author:	flint2
association:	contributor
edited:	false
status:	none
--
> Does `webkit-gtk` build for you, and if so, how does its compilation time compare to 2.40?
> 
> I'm seeing some `cc1plus` processes running for an insanely long time -- like 13 minutes at least.

I´m seeing similar times to 2.40 in  2 machines

teco ~ # lscpu|grep Model 
Model name:                      11th Gen Intel(R) Core(TM) i5-11500H @ 2.90GHz
BIOS Model name:                 11th Gen Intel(R) Core(TM) i5-11500H @ 2.90GHz   CPU @ 4.1GHz
Model:                           141
teco ~ # qlop -v webkit-gtk            
2023-05-18T11:05:25 >>> net-libs/webkit-gtk-2.40.1-r410: 1:52:46
2023-05-18T13:07:43 >>> net-libs/webkit-gtk-2.40.1-r600: 1:51:28
2023-05-20T12:18:39 >>> net-libs/webkit-gtk-2.40.1-r410: 1:31:59
2023-05-20T13:50:50 >>> net-libs/webkit-gtk-2.40.1-r600: 1:30:41
2023-05-30T19:03:11 >>> net-libs/webkit-gtk-2.40.2-r410: 1:33:01
2023-05-30T20:37:23 >>> net-libs/webkit-gtk-2.40.2-r600: 1:34:50
2023-07-01T11:22:36 >>> net-libs/webkit-gtk-2.41.5-r600: 1:33:58
2023-07-02T11:24:57 >>> net-libs/webkit-gtk-2.40.3-r410: 1:34:18
2023-07-09T17:17:27 >>> net-libs/webkit-gtk-2.41.6-r600: 1:35:45





sisko gentoo # lscpu|grep Model                                                                                                      (git)-[emerge]-
Model name:                      AMD Ryzen 7 5800X 8-Core Processor
BIOS Model name:                   CPU @ 0.0GHz
Model:                           33
sisko gentoo # qlop -v webkit-gtk|tail -10                                                                                           (git)-[emerge]-
2023-04-22T12:37:26 >>> net-libs/webkit-gtk-2.40.1-r600: 42′42″
2023-05-23T16:55:51 >>> net-libs/webkit-gtk-2.40.1-r410: 1:48:46
2023-05-23T18:44:48 >>> net-libs/webkit-gtk-2.40.1: 1:42:23
2023-05-23T20:29:36 >>> net-libs/webkit-gtk-2.40.1-r600: 1:31:45
2023-05-31T17:01:50 >>> net-libs/webkit-gtk-2.40.2-r410: 1:26:49
2023-05-31T18:29:26 >>> net-libs/webkit-gtk-2.40.2: 1:46:50
2023-06-01T01:30:23 >>> net-libs/webkit-gtk-2.40.2-r600: 1:31:28
2023-07-01T10:57:38 >>> net-libs/webkit-gtk-2.41.5-r600: 2:30:43
2023-07-02T16:15:29 >>> net-libs/webkit-gtk-2.40.3-r410: 10:38:34
2023-07-03T13:52:13 >>> net-libs/webkit-gtk-2.40.3: 1:34:41

--
author:	mattst88
association:	contributor
edited:	false
status:	none
--
I'm investigating the build time increases. It seems to be a `sys-apps/sandbox` regression in v2.30.
--
author:	mattst88
association:	contributor
edited:	false
status:	none
--
Looks like we've figured it out, mostly: https://bugs.gentoo.org/910273
--
author:	flint2
association:	contributor
edited:	true
status:	none
--
webkit-gtk 2.41.90 released
13/14 epiphany test OK

```
stderr:
/usr/lib64/gtk-4.0/4.0.0/printbackends/libprintbackend-cups.so: undefined symbol: gtk_printer_option_set
Failed to load module: /usr/lib64/gtk-4.0/4.0.0/printbackends/libprintbackend-cups.so
/usr/lib64/gtk-4.0/4.0.0/printbackends/libprintbackend-file.so: undefined symbol: gtk_printer_option_set
Failed to load module: /usr/lib64/gtk-4.0/4.0.0/printbackends/libprintbackend-file.so
bwrap: setting up uid map: Permission denied



Summary of Failures:

12/14 Encodings test             FAIL            0.32s   killed by signal 6 SIGABRT
14/14 Web view test              TIMEOUT        30.02s   killed by signal 15 SIGTERM

Ok:                 12
Expected Fail:      0
Fail:               1
Unexpected Pass:    0
Skipped:            0
Timeout:            1
```


/var/tmp/portage/www-client/epiphany-45_beta/work/epiphany-45_beta-build/meson-logs/testlog.txt
```
=================================== 14/14 ====================================
test:         Web view test
start time:   00:39:27
duration:     30.02s
result:       killed by signal 15 SIGTERM
command:      PATH='/var/tmp/portage/www-client/epiphany-45_beta/work/epiphany-45_beta-build/src:/usr/lib/portage/python3.11/ebuild-helpers/xattr:/usr/lib/portage/python3.11/ebuild-helpers:/usr/local/sbin:/usr/local/bin:/usr/bin:/opt/bin:/usr/lib/llvm/16/bin:/opt/android-sdk-update-manager/tools:/opt/android-sdk-update-manager/platform-tools
' GSETTINGS_BACKEND=memory GSETTINGS_SCHEMA_DIR=/var/tmp/portage/www-client/epiphany-45_beta/work/epiphany-45_beta-build/data G_TEST_SRCDIR=/var/tmp/portage/www-client/epiphany-45_beta/work/epiphany-45.beta/tests G_TEST_BUILDDIR=/var/tmp/portage/www-client/epiphany-45_beta/work/epiphany-45_beta-build/tests MALLOC_PERTURB_=138 LD_LIBRARY_PATH=/var/tmp/portage/www-client/epiphany-45_beta/work/epiphany-45_beta-build/lib/sync:/var/tmp/portage/www-client/epiphany-45_beta/work/epiphany-45_beta-build/src:/var/tmp/portage/www-client/epiphany-45_beta/work/epiphany-45_beta-build/lib /var/tmp/portage/www-client/epiphany-45_beta/work/epiphany-45_beta-build/tests/test-ephy-web-view
----------------------------------- stdout -----------------------------------
TAP version 13
# random seed: R02S2feec6ced6e2814dbe648d4a893c705b
# GLib-GIO-DEBUG: Using cross-namespace EXTERNAL authentication (this will deadlock if server is GDBus < 2.73.3)
1..5
# Start of embed tests
# Start of ephy-web-view tests
# SEARCH                localhost localdomain:8080/home/
# SEARCH                ./
# NO SEARCH             localhost
# NO SEARCH             localhost.localdomain
# NO SEARCH             localhost.localdomain:8080
# NO SEARCH             localhost.localdomain:8080/home/
# NO SEARCH             gnome.org
# NO SEARCH             www.gnome.org
# NO SEARCH             http://www.gnome.org
# NO SEARCH             192.168.1.1
# NO SEARCH             192.168.1.1:80
# NO SEARCH             f80e::2a1:f85f:fc8f:a0d1
ok 1 /embed/ephy-web-view/non_search_regex
ok 2 /embed/ephy-web-view/normalize_or_autosearch
----------------------------------- stderr -----------------------------------
/usr/lib64/gtk-4.0/4.0.0/printbackends/libprintbackend-cups.so: undefined symbol: gtk_printer_option_set
Failed to load module: /usr/lib64/gtk-4.0/4.0.0/printbackends/libprintbackend-cups.so
/usr/lib64/gtk-4.0/4.0.0/printbackends/libprintbackend-file.so: undefined symbol: gtk_printer_option_set
Failed to load module: /usr/lib64/gtk-4.0/4.0.0/printbackends/libprintbackend-file.so
bwrap: setting up uid map: Permission denied
==============================================================================

``` 






--
author:	flint2
association:	contributor
edited:	false
status:	none
--



```

-- Found GStreamer: GSTREAMER_INCLUDE_DIRS;GSTREAMER_LIBRARIES;GSTREAMER_VERSION;GSTREAMER_BASE_INCLUDE_DIRS;GSTREAMER_BASE_LIBRARIES;GSTREAMER_APP_INCLUDE_DIRS;GSTREAMER_APP_LIBRARIES;GSTREAMER_PBUTILS_INCLUDE_DIRS;GSTREAMER_PBUTILS_LIBRARIES;GSTREAMER_VIDEO_INCLUDE_DIRS;GSTREAMER_VIDEO_LIBRARIES;GSTREAMER_MPEGTS_INCLUDE_DIRS;GSTREAMER_MPEGTS_LIBRARIES;GSTREAMER_TAG_INCLUDE_DIRS;GSTREAMER_TAG_LIBRARIES;GSTREAMER_GL_INCLUDE_DIRS;GSTREAMER_GL_LIBRARIES;GSTREAMER_AUDIO_INCLUDE_DIRS;GSTREAMER_AUDIO_LIBRARIES;GSTREAMER_FFT_INCLUDE_DIRS;GSTREAMER_FFT_LIBRARIES;GSTREAMER_TRANSCODER_INCLUDE_DIRS;GSTREAMER_TRANSCODER_LIBRARIES (Required is at least version "1.18.4") 
CMake Error at Source/cmake/GStreamerChecks.cmake:62 (message):
  GStreamerTranscoder >= 1.20 is needed for USE_GSTREAMER_TRANSCODER.
Call Stack (most recent call first):
  Source/cmake/OptionsGTK.cmake:520 (include)
  Source/cmake/WebKitCommon.cmake:228 (include)
  CMakeLists.txt:21 (include)


-- Configuring incomplete, errors occurred!
 * ERROR: net-libs/webkit-gtk-2.41.92-r600::gentoo failed (configure phase):
 *   cmake failed
 * 
 * Call stack:
 *     ebuild.sh, line  136:  Called src_configure
 *   environment, line 3744:  Called cmake_src_configure
 *   environment, line 1735:  Called die
 * The specific snippet of code:
 *       "${CMAKE_BINARY}" "${cmakeargs[@]}" "${CMAKE_USE_DIR}" || die "cmake failed";
 * 
 * If you need support, post the output of `emerge --info '=net-libs/webkit-gtk-2.41.92-r600::gentoo'`,
 * the complete build log and the output of `emerge -pqv '=net-libs/webkit-gtk-2.41.92-r600::gentoo'`.
 * The complete build log is located at '/var/tmp/notmpfs/portage/net-libs/webkit-gtk-2.41.92-r600/temp/build.log'.
 * The ebuild environment file is located at '/var/tmp/notmpfs/portage/net-libs/webkit-gtk-2.41.92-r600/temp/environment'.
 * Working directory: '/var/tmp/notmpfs/portage/net-libs/webkit-gtk-2.41.92-r600/work/webkitgtk-2.41.92_build'
 * S: '/var/tmp/notmpfs/portage/net-libs/webkit-gtk-2.41.92-r600/work/webkitgtk-2.41.92'

```
--
author:	flint2
association:	contributor
edited:	false
status:	none
--
webkit-gtk 2.42.0 Released
https://github.com/gentoo/gentoo/pull/32810
--
author:	gentoo-bot
association:	none
edited:	false
status:	none
--
## Pull Request assignment

*Submitter*: @flint2
*Areas affected*: ebuilds
*Packages affected*: www-client/epiphany

**www-client/epiphany**: @gentoo/gnome

## Linked bugs

No bugs to link found. If your pull request references any of the Gentoo bug reports, please add appropriate [GLEP 66](https://www.gentoo.org/glep/glep-0066.html#commit-messages) tags to the commit message and request reassignment.

**If you do not receive any reply to this pull request, please open or link a bug to attract the attention of maintainers.**

---
In order to force reassignment and/or bug reference scan, please append `[please reassign]` to the pull request title.

*Docs*: [Code of Conduct](https://wiki.gentoo.org/wiki/Project:Council/Code_of_conduct) ● [Copyright policy](https://www.gentoo.org/glep/glep-0076.html) ([expl.](https://dev.gentoo.org/~mgorny/articles/new-gentoo-copyright-policy-explained.html)) ● [Devmanual](https://devmanual.gentoo.org/) ● [GitHub PRs](https://wiki.gentoo.org/wiki/Project:GitHub/Pull_requests) ● [Proxy-maint guide](https://wiki.gentoo.org/wiki/Project:Proxy_Maintainers/User_Guide)
--
author:	pacho2
association:	member
edited:	false
status:	none
--
Thanks for the updated PR

Are you also getting this test failure?
```
stderr:
bwrap: setting up uid map: Permission denied

** (/var/tmp/portage/www-client/epiphany-45.0/work/epiphany-45.0-build/tests/test-ephy-web-view:324): ERROR **: 13:45:36.748: Failed to fully launch dbus-proxy: Child process exited with code 1



Summary of Failures:

13/14 Encodings test             FAIL            0.86s   killed by signal 6 SIGABRT
14/14 Web view test              FAIL            0.84s   killed by signal 5 SIGTRAP

Ok:                 12  
Expected Fail:      0   
Fail:               2   
Unexpected Pass:    0   
Skipped:            0   
Timeout:            0   
```

I see emacs ebuild is skipping some tests due to a similar issue when bubblewrap is present :/
--
author:	flint2
association:	contributor
edited:	false
status:	none
--
> Thanks for the updated PR
> 
> Are you also getting this test failure?
> 
> ```
> stderr:
> bwrap: setting up uid map: Permission denied
> 
> ** (/var/tmp/portage/www-client/epiphany-45.0/work/epiphany-45.0-build/tests/test-ephy-web-view:324): ERROR **: 13:45:36.748: Failed to fully launch dbus-proxy: Child process exited with code 1
> 
> 
> 
> Summary of Failures:
> 
> 13/14 Encodings test             FAIL            0.86s   killed by signal 6 SIGABRT
> 14/14 Web view test              FAIL            0.84s   killed by signal 5 SIGTRAP
> 
> Ok:                 12  
> Expected Fail:      0   
> Fail:               2   
> Unexpected Pass:    0   
> Skipped:            0   
> Timeout:            0   
> ```
> 
> I see emacs ebuild is skipping some tests due to a similar issue when bubblewrap is present :/

Yes, I have the same errors, even with sys-apps/bubblewrap suid
--
author:	pacho2
association:	member
edited:	false
status:	none
--
I have tried to report to upstream:
https://gitlab.gnome.org/GNOME/epiphany/-/issues/2209

Otherwise we would need to skip the broken tests I think :/

--
author:	gentoo-repo-qa-bot
association:	collaborator
edited:	false
status:	none
--
## Pull request CI report

*Report generated at*: 2024-01-06 00:43 UTC
*Newest commit scanned*: 9f613209de9cdd7c2b2c19f41d4c88d9fd2da619
*Status*: :x: **broken**

New issues caused by PR:
https://qa-reports.gentoo.org/output/gentoo-ci/8025784426/output.html#www-client/epiphany

There are existing issues already. Please look into the report to make sure none of them affect the packages in question:
https://qa-reports.gentoo.org/output/gentoo-ci/8025784426/output.html

--
author:	flint2
association:	contributor
edited:	false
status:	none
--
Closed because rebase and cleanup
--
