Author: Philip Rinn <rinni@inventati.org>
Description: Fix CVE-2015-3885
Source: https://github.com/rawstudio/rawstudio/commit/983bda1f0fa5fa86884381208274198a620f006e
Last-update: 2015-05-14
--- a/rtengine/dcraw.c
+++ b/rtengine/dcraw.c
@@ -824,7 +824,8 @@
 
 int CLASS ljpeg_start (struct jhead *jh, int info_only)
 {
-  int c, tag, len;
+  int c, tag;
+  ushort len;
   uchar data[0x10000];
   const uchar *dp;
 
--- a/rtengine/dcraw.cc
+++ b/rtengine/dcraw.cc
@@ -787,7 +787,8 @@
 
 int CLASS ljpeg_start (struct jhead *jh, int info_only)
 {
-  int c, tag, len;
+  int c, tag;
+  ushort len;
   uchar data[0x10000];
   const uchar *dp;
 
