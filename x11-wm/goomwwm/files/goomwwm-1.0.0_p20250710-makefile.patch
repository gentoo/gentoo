--- a/Makefile
+++ b/Makefile
@@ -1,11 +1,10 @@
-CFLAGS?=-Wall -Os
-LDADD?=`pkg-config --cflags --libs x11 xinerama xft`
+PKG_CONFIG ?= pkg-config
+CFLAGS ?= -Wall -Os
+CPPFLAGS += $(shell $(PKG_CONFIG) --cflags x11 xinerama xft)
+LDLIBS += $(shell $(PKG_CONFIG) --libs x11 xinerama xft)
 
-normal:
-	$(CC) -o goomwwm goomwwm.c $(CFLAGS) $(LDADD) $(LDFLAGS)
-
-debug:
-	$(CC) -o goomwwm-debug goomwwm.c $(CFLAGS) -g -DDEBUG $(LDADD)
+all: goomwwm
+goomwwm.c: proto
 
 proto:
 	cat *.c | egrep '^(void|int|char|unsigned|client|Window|winlist|box|textbox|XWindow)' | sed -r 's/\)/);/' > proto.h
@@ -13,7 +12,5 @@ proto:
 docs:
 	pandoc -s -w man goomwwm.md -o goomwwm.1
 
-all: proto normal debug docs
-
 clean:
-	rm -f goomwwm goomwwm-debug
\ No newline at end of file
+	rm -f goomwwm goomwwm-debug
