diff --git a/src/cpp/flann/mpi/client.h b/src/cpp/flann/mpi/client.h
index 19a410c..c610c3d 100644
--- a/src/cpp/flann/mpi/client.h
+++ b/src/cpp/flann/mpi/client.h
@@ -45,17 +45,17 @@ class Client
 public:
 	Client(const std::string& host, const std::string& service)
 	{
-	    tcp::resolver resolver(io_service_);
-	    tcp::resolver::query query(tcp::v4(), host, service);
-	    iterator_ = resolver.resolve(query);
+            tcp::resolver resolver(io_context_);
+            auto results = resolver.resolve(host, service);
+            results_ = resolver.resolve(host, service);
 	}
 
 
 	template<typename ElementType, typename DistanceType>
 	void knnSearch(const flann::Matrix<ElementType>& queries, flann::Matrix<int>& indices, flann::Matrix<DistanceType>& dists, int knn, const SearchParams& params)
 	{
-	    tcp::socket sock(io_service_);
-	    sock.connect(*iterator_);
+	    tcp::socket sock(io_context_);
+            boost::asio::connect(sock, results_);
 
 	    Request<ElementType> req;
 	    req.nn = knn;
@@ -78,8 +78,8 @@ public:
 
 
 private:
-	boost::asio::io_service io_service_;
-	tcp::resolver::iterator iterator_;
+	boost::asio::io_context io_context_;
+        tcp::resolver::results_type results_;
 };
 
 
diff --git a/src/cpp/flann/mpi/server.h b/src/cpp/flann/mpi/server.h
index 2caab43..9d10280 100644
--- a/src/cpp/flann/mpi/server.h
+++ b/src/cpp/flann/mpi/server.h
@@ -119,11 +119,11 @@ public:
 	void run()
 	{
 		boost::mpi::communicator world;
-		boost::shared_ptr<boost::asio::io_service> io_service;
+		boost::shared_ptr<boost::asio::io_context> io_service;
 		boost::shared_ptr<tcp::acceptor> acceptor;
 
 		if (world.rank()==0) {
-			io_service.reset(new boost::asio::io_service());
+			io_service.reset(new boost::asio::io_context());
 			acceptor.reset(new tcp::acceptor(*io_service, tcp::endpoint(tcp::v4(), port_)));
 			std::cout << "Start listening for queries...\n";
 		}
