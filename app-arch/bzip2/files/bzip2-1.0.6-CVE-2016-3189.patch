Upstream-Status: Backport
https://bugzilla.suse.com/attachment.cgi?id=681334

CVE: CVE-2016-3189
Signed-off-by: Armin Kuster <akuster@mvista.com>

Index: bzip2-1.0.6/bzip2recover.c
===================================================================
--- bzip2-1.0.6.orig/bzip2recover.c
+++ bzip2-1.0.6/bzip2recover.c
@@ -457,6 +457,7 @@ Int32 main ( Int32 argc, Char** argv )
             bsPutUChar ( bsWr, 0x50 ); bsPutUChar ( bsWr, 0x90 );
             bsPutUInt32 ( bsWr, blockCRC );
             bsClose ( bsWr );
+            outFile = NULL;
          }
          if (wrBlock >= rbCtr) break;
          wrBlock++;
