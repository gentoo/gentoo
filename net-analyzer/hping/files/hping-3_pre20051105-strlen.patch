--- a/ip_opt_build.c
+++ b/ip_opt_build.c
@@ -25,7 +25,7 @@
 	unsigned char optlen = 0;
 	unsigned long ip;
 
-    memset(ip_opt, 1, sizeof(ip_opt));
+    memset(ip_opt, 1, strlen(ip_opt));
 
     if (opt_lsrr)
     {
